---
import { getDraft } from '../../utils/sanity'
import Layout from '../../layouts/Layout.astro'
import PageView from '../../components/views/PageView.astro'
import PostView from '../../components/views/PostView.astro'
import FourOhFour from '../../components/views/404.astro'

export const prerender = false

const draftId = Astro.url.searchParams.get('draftId')! || '';
const { documentType } = Astro.params
const props = await getDraft(draftId)

const seo = {
  title: props.title,
  description: props.excerpt,
  image: props.featuredImage,
  url: `https://astro.build${Astro.url.pathname}`
}

let ViewToRender = null

switch (documentType) {
  case 'page':
    ViewToRender = PageView
    break
  case 'post':
    ViewToRender = PostView
    break
  default:
    ViewToRender = FourOhFour
}
---

<Layout title={props.title}>
  <ViewToRender {...props} />
</Layout>