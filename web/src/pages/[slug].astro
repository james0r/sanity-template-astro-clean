---
import Layout from '../layouts/Layout.astro'
import { getPages, getPage } from '../utils/sanity'

import PageView from '../components/views/PageView.astro'
import { truncateTextWithEllipsis } from '@/utils'

export const prerender = true

export async function getStaticPaths() {
  const posts = await getPages()
  return posts.map((page) => ({
    params: { slug: page.slug.current },
  }))
}

const { slug } = Astro.params
const props = await getPage(slug)

const seo = {
  title: props.title,
  image: props.featuredImage,
}
---

<Layout title={props.title} seo={seo}>
  <PageView {...props} />
</Layout>
